{"ast":null,"code":"import { API_URL } from '@/config/index'; //import { API_URL, TOKEN_URL, CREDENTIALS } from '@/config/index';\n\nexport default (async (req, res) => {\n  if (req.method === 'POST') {\n    const res = await fetch(`${API_URL}/time-token`);\n    const time = await res.json();\n    const now = new Date().getTime();\n    const oldtime = +time.time;\n    const deference = now - oldtime; //console.log(deference)\n\n    if (res.ok) {\n      res.status(200).json(deference);\n    } else {\n      res.status(data.statusCode).json({\n        message: data.message[0].messages[0].message\n      });\n    } // if (deference >= 290000) {\n    //   //console.log(deference + ' working!')\n    //   const qlsRes = await fetch(`${TOKEN_URL}`, {\n    //     method: 'post',\n    //     headers: {\n    //       Authorization:\n    //         'Basic ' + Buffer.from(`${CREDENTIALS}`).toString('base64'),\n    //       'Content-Type': 'application/json',\n    //     },\n    //   });\n    //   const data = await qlsRes.json();\n    //   const values = {\n    //     token: data.access_token,\n    //     time: +now,\n    //   };\n    //   const res2 = await fetch(`${API_URL}/time-token`, {\n    //     method: 'PUT',\n    //     headers: {\n    //       'Content-Type': 'application/json',\n    //       //  Authorization: `Bearer ${token}`,\n    //     },\n    //     body: JSON.stringify(values),\n    //   });\n    //   if (!res2.ok) {\n    //     toast.error('Something Went Wrong');\n    //   } else {\n    //     const evt = await res2.json();\n    //     toast('Updat Susses!');\n    //   }\n    // }\n    // const res3 = await fetch(`${API_URL}/time-token`);\n    // const newTime = await res3.json();\n\n  } else {\n    res.setHeader('Allow', ['POST']);\n    res.status(405).json({\n      message: `Method ${req.method} not allowed`\n    });\n  }\n});","map":{"version":3,"sources":["E:/azizyar/front/pages/api/token.js"],"names":["API_URL","req","res","method","fetch","time","json","now","Date","getTime","oldtime","deference","ok","status","data","statusCode","message","messages","setHeader"],"mappings":"AAAA,SAASA,OAAT,QAAwB,gBAAxB,C,CACA;;AACA,gBAAe,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACjC,MAAID,GAAG,CAACE,MAAJ,KAAe,MAAnB,EAA2B;AACzB,UAAMD,GAAG,GAAG,MAAME,KAAK,CAAE,GAAEJ,OAAQ,aAAZ,CAAvB;AACA,UAAMK,IAAI,GAAG,MAAMH,GAAG,CAACI,IAAJ,EAAnB;AAEA,UAAMC,GAAG,GAAG,IAAIC,IAAJ,GAAWC,OAAX,EAAZ;AACA,UAAMC,OAAO,GAAG,CAACL,IAAI,CAACA,IAAtB;AACA,UAAMM,SAAS,GAAGJ,GAAG,GAAGG,OAAxB,CANyB,CAOzB;;AAEA,QAAIR,GAAG,CAACU,EAAR,EAAY;AACVV,MAAAA,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBP,IAAhB,CAAqBK,SAArB;AACD,KAFD,MAEO;AACLT,MAAAA,GAAG,CACAW,MADH,CACUC,IAAI,CAACC,UADf,EAEGT,IAFH,CAEQ;AAAEU,QAAAA,OAAO,EAAEF,IAAI,CAACE,OAAL,CAAa,CAAb,EAAgBC,QAAhB,CAAyB,CAAzB,EAA4BD;AAAvC,OAFR;AAGD,KAfwB,CAiBzB;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;AACD,GAtDD,MAsDO;AACLd,IAAAA,GAAG,CAACgB,SAAJ,CAAc,OAAd,EAAuB,CAAC,MAAD,CAAvB;AACAhB,IAAAA,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBP,IAAhB,CAAqB;AAAEU,MAAAA,OAAO,EAAG,UAASf,GAAG,CAACE,MAAO;AAAhC,KAArB;AACD;AACF,CA3DD","sourcesContent":["import { API_URL } from '@/config/index';\r\n//import { API_URL, TOKEN_URL, CREDENTIALS } from '@/config/index';\r\nexport default async (req, res) => {\r\n  if (req.method === 'POST') {\r\n    const res = await fetch(`${API_URL}/time-token`);\r\n    const time = await res.json();\r\n\r\n    const now = new Date().getTime();\r\n    const oldtime = +time.time;\r\n    const deference = now - oldtime;\r\n    //console.log(deference)\r\n\r\n    if (res.ok) {\r\n      res.status(200).json(deference);\r\n    } else {\r\n      res\r\n        .status(data.statusCode)\r\n        .json({ message: data.message[0].messages[0].message });\r\n    }\r\n\r\n    // if (deference >= 290000) {\r\n    //   //console.log(deference + ' working!')\r\n\r\n    //   const qlsRes = await fetch(`${TOKEN_URL}`, {\r\n    //     method: 'post',\r\n    //     headers: {\r\n    //       Authorization:\r\n    //         'Basic ' + Buffer.from(`${CREDENTIALS}`).toString('base64'),\r\n    //       'Content-Type': 'application/json',\r\n    //     },\r\n    //   });\r\n    //   const data = await qlsRes.json();\r\n\r\n    //   const values = {\r\n    //     token: data.access_token,\r\n    //     time: +now,\r\n    //   };\r\n\r\n    //   const res2 = await fetch(`${API_URL}/time-token`, {\r\n    //     method: 'PUT',\r\n    //     headers: {\r\n    //       'Content-Type': 'application/json',\r\n    //       //  Authorization: `Bearer ${token}`,\r\n    //     },\r\n    //     body: JSON.stringify(values),\r\n    //   });\r\n\r\n    //   if (!res2.ok) {\r\n    //     toast.error('Something Went Wrong');\r\n    //   } else {\r\n    //     const evt = await res2.json();\r\n    //     toast('Updat Susses!');\r\n    //   }\r\n    // }\r\n\r\n    // const res3 = await fetch(`${API_URL}/time-token`);\r\n    // const newTime = await res3.json();\r\n  } else {\r\n    res.setHeader('Allow', ['POST']);\r\n    res.status(405).json({ message: `Method ${req.method} not allowed` });\r\n  }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}