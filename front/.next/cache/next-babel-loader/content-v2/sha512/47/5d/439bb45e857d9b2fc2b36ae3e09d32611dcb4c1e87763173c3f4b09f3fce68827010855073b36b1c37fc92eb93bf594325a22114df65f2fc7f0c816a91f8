{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/Users/ahmaddev/Apps/New_app/front/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/ahmaddev/Apps/New_app/front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/Users/ahmaddev/Apps/New_app/front/context/AuthContext.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport { createContext, useState, useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport { NEXT_URL } from '@/config/index';\nvar AuthContext = /*#__PURE__*/createContext();\nexport var AuthProvider = function AuthProvider(_ref) {\n  _s();\n\n  var children = _ref.children;\n\n  var _useState = useState(null),\n      user = _useState[0],\n      setUser = _useState[1];\n\n  var _useState2 = useState(null),\n      error = _useState2[0],\n      setError = _useState2[1];\n\n  var router = useRouter();\n  useEffect(function () {\n    return checkUserLoggedIn();\n  }, []); // Register user\n\n  var register = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(user) {\n      var res, data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return fetch(\"\".concat(NEXT_URL, \"/api/register\"), {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(user)\n              });\n\n            case 2:\n              res = _context.sent;\n              _context.next = 5;\n              return res.json();\n\n            case 5:\n              data = _context.sent;\n\n              if (res.ok) {\n                setUser(data.user);\n                router.push('/account/dashboard');\n              } else {\n                setError(data.message);\n                setError(null);\n              }\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function register(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(); // Login user\n\n\n  var login = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref3) {\n      var identifier, password, res, data;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              identifier = _ref3.email, password = _ref3.password;\n              _context2.next = 3;\n              return fetch(\"\".concat(NEXT_URL, \"/api/login\"), {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                  identifier: identifier,\n                  password: password\n                })\n              });\n\n            case 3:\n              res = _context2.sent;\n              _context2.next = 6;\n              return res.json();\n\n            case 6:\n              data = _context2.sent;\n\n              if (res.ok) {\n                setUser(data.user);\n                router.push('/account/dashboard');\n              } else {\n                setError(data.message);\n                setError(null);\n              }\n\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function login(_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }(); // Logout user\n\n\n  var logout = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return fetch(\"\".concat(NEXT_URL, \"/api/logout\"), {\n                method: 'POST'\n              });\n\n            case 2:\n              res = _context3.sent;\n\n              if (res.ok) {\n                setUser(null);\n                router.push('/');\n              }\n\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function logout() {\n      return _ref5.apply(this, arguments);\n    };\n  }(); // Check if user is logged in\n\n\n  var checkUserLoggedIn = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(user) {\n      var res, data;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return fetch(\"\".concat(NEXT_URL, \"/api/user\"));\n\n            case 2:\n              res = _context4.sent;\n              _context4.next = 5;\n              return res.json();\n\n            case 5:\n              data = _context4.sent;\n\n              if (res.ok) {\n                setUser(data.user);\n              } else {\n                setUser(null);\n              }\n\n            case 7:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function checkUserLoggedIn(_x3) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user: user,\n      error: error,\n      register: register,\n      login: login,\n      logout: logout\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(AuthProvider, \"YsCDDfjtsa03iRyjr2jNLxLWeXI=\", false, function () {\n  return [useRouter];\n});\n\n_c = AuthProvider;\nexport default AuthContext;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["/Users/ahmaddev/Apps/New_app/front/context/AuthContext.js"],"names":["createContext","useState","useEffect","useRouter","NEXT_URL","AuthContext","AuthProvider","children","user","setUser","error","setError","router","checkUserLoggedIn","register","fetch","method","headers","body","JSON","stringify","res","json","data","ok","push","message","login","identifier","email","password","logout"],"mappings":"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","sourcesContent":["import { createContext, useState, useEffect } from 'react'\nimport { useRouter } from 'next/router'\nimport { NEXT_URL } from '@/config/index'\n\nconst AuthContext = createContext()\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null)\n  const [error, setError] = useState(null)\n\n  const router = useRouter()\n\n  useEffect(() => checkUserLoggedIn(), [])\n\n  // Register user\n  const register = async (user) => {\n    const res = await fetch(`${NEXT_URL}/api/register`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(user),\n    })\n\n    const data = await res.json()\n\n    if (res.ok) {\n      setUser(data.user)\n      router.push('/account/dashboard')\n    } else {\n      setError(data.message)\n      setError(null)\n    }\n  }\n\n  // Login user\n  const login = async ({ email: identifier, password }) => {\n    const res = await fetch(`${NEXT_URL}/api/login`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        identifier,\n        password,\n      }),\n    })\n\n    const data = await res.json()\n\n    if (res.ok) {\n      setUser(data.user)\n      router.push('/account/dashboard')\n    } else {\n      setError(data.message)\n      setError(null)\n    }\n  }\n\n  // Logout user\n  const logout = async () => {\n    const res = await fetch(`${NEXT_URL}/api/logout`, {\n      method: 'POST',\n    })\n\n    if (res.ok) {\n      setUser(null)\n      router.push('/')\n    }\n  }\n\n  // Check if user is logged in\n  const checkUserLoggedIn = async (user) => {\n    const res = await fetch(`${NEXT_URL}/api/user`)\n    const data = await res.json()\n\n    if (res.ok) {\n      setUser(data.user)\n    } else {\n      setUser(null)\n    }\n  }\n\n  return (\n    <AuthContext.Provider value={{ user, error, register, login, logout }}>\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\nexport default AuthContext\n"]},"metadata":{},"sourceType":"module"}